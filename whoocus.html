<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Whoocus  </title>


<link rel="pingback" href="http://www.whoocus.com/blog/xmlrpc.php" />
<link rel="stylesheet" type="text/css" media="all" href="http://www.whoocus.com/blog/wp-content/themes/gray-and-gold/style.css" />

<link rel="alternate" type="application/rss+xml" title="Whoocus &raquo; フィード" href="http://www.whoocus.com/blog/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="Whoocus &raquo; コメントフィード" href="http://www.whoocus.com/blog/?feed=comments-rss2" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.whoocus.com\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.1"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='jetpack_css-css'  href='http://www.whoocus.com/blog/wp-content/plugins/jetpack/css/jetpack.css?ver=3.7.2' type='text/css' media='all' />
<script type='text/javascript' src='http://www.whoocus.com/blog/wp-includes/js/jquery/jquery.js?ver=1.11.3'></script>
<script type='text/javascript' src='http://www.whoocus.com/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.whoocus.com/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.whoocus.com/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.3.1" />
<link rel='shortlink' href='http://wp.me/6NPdG' />
<style type='text/css'>img#wpstats{display:none}</style><style type="text/css">
#titel {
	float: left;
	padding: 0px 0 0 0px;
	color: #FFF;
	width: 855px;
	height:134px;
}

#header{
background: url(http://www.whoocus.com/blog/wp-content/themes/gray-and-gold/design/header.png) repeat-x;
/*height: 170px;*/
height: 170px;
margin: 0 0;
padding: 0 0;
background-color: #353530;
}
</style>

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="Whoocus" />
<meta property="og:description" content="人と人をつなげるシステムを創造する" />
<meta property="og:url" content="http://www.whoocus.com/blog/" />
<meta property="og:site_name" content="Whoocus" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="ja_JP" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
<body class="home blog">

<div id="wrapper-top-navigation">
	<div class="center_wrapper">
	</div>
</div>
<div id="header">
	<div class="center_wrapper">
	
		  <div id="logo">
            <div id="titel">
                 <h1><a href="http://www.whoocus.com/blog/" title="Whoocus - 人と人をつなげるシステムを創造する" rel="home">Whoocus</a></h1>
                 <h2>人と人をつなげるシステムを創造する</h2>
             </div>
    		</div>
	    </div>
    </div>
<div id="wrapper-navigation">
	<div id="navigation">
		<div class="center_wrapper">
        <div class="menu">
			<div class="menu"><ul><li class="page_item page-item-6"><a href="http://www.whoocus.com/blog/?page_id=6">Whoocusとは</a></li></ul></div>
 
            </div>
		</div>
	</div> 
</div>
<!-- Image under menu -->  
<div id="bodyheader"></div>    
<div id="layout_body">
	<div id="main_wrapper_outer">
		<div id="main_wrapper_inner">
			<div class="center_wrapper"><!--Content placement-->
<div class="left" id="main">
    <div id="main_content">
<div class="post-2459 post type-post status-publish format-standard hentry category-centos category-tech" id="post-2459">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2459" rel="bookmark" title="Read-only file system のファイルシステムエラー発生">Read-only file system のファイルシステムエラー発生</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年8月1日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<p><strong>■現象</strong><br />
○SVNコミット時に下記エラーで、コミットできない。</p>
<pre class="brush: bash; title: ; notranslate" title="">
　　選択されたリソースのいくつかがコミットされませんでした。
　　svn: E204900: Commit failed (details follow):
　　svn: E204900: Can't create directory '/var/www/svn/repos/project/db/transactions/12345-1.txn': Read-only file system
　　svn: E175002: MKACTIVITY of '/svn/repo/project/!svn/act/b2f11144-123-0010-abcd-c12345678f7': 500 Internal Server Error (http://xx.xx.xx.xx)


</pre>
<p><strong>■原因</strong><br />
○svnレポジトリ他、/mydisc に対するファイル書き込みができなくなっている。</p>
<p><strong>■対応内容</strong><br />
○/mydisc に対して再マウント ⇒ 失敗</p>
<pre class="brush: bash; title: ; notranslate" title="">
　　[root]# mount -o remount /dev/sdc1
　　mount: ブロックデバイス /dev/sdc1 は書き込み禁止です、読込み専用でマウントします
</pre>
<p>○/mydisc に対してアンマウント ⇒ 失敗</p>
<pre class="brush: bash; title: ; notranslate" title="">
　　[root]# umount /dev/sdc1
　　umount: /mydisc: デバイスを使用中です
</pre>
<p>○/mydisc を利用中のプロセス確認</p>
<pre class="brush: bash; title: ; notranslate" title="">
　　[root]# fuser -muv /dev/sdc1
      USER        PID ACCESS COMMAND
　　/dev/sdc1:           root       2461 F.... (root)httpd
　　root       5684 F.... (root)PassengerWatchd
　　root       5687 F.... (root)PassengerHelper
　　root       5696 F.... (root)ruby
　　nobody     5700 F.... (nobody)PassengerLoggin
　　apache     5720 F.... (apache)httpd
　　apache     5721 F.... (apache)httpd
　　apache     5722 F.... (apache)httpd
　　mysql     11773 F.c.. (mysql)mysqld
　　root      14145 F.... (root)java
</pre>
<p>○/mydisc を利用中の httpd / mysqld / java プロセス終了</p>
<pre class="brush: bash; title: ; notranslate" title="">
　　[root]# /etc/rc.d/init.d/httpd stop
　　httpd を停止中:                                            [  OK  ]
　　[root]# /etc/rc.d/init.d/mysqld stop
　　MySQL を停止中:                                            [  OK  ]
　　[root]# fuser -muv /dev/sdc1
　　USER        PID ACCESS COMMAND
　　/dev/sdc1:           root      14145 F.... (root)java
　　[root]# kill -KILL 14145
</pre>
<p>○/mydisc に対してアンマウント ⇒ 成功</p>
<pre class="brush: bash; title: ; notranslate" title="">
　　[root]# umount /dev/sdc1
</pre>
<p>○マウントの確認</p>
<pre class="brush: bash; title: ; notranslate" title="">
　　[root]# mount -t ext3 /dev/sdc1 /mydisc
</pre>
<pre class="brush: bash; title: ; notranslate" title="">
　　[root]# mount -v
　　/dev/sdc1 on /mydisc type ext3 (rw)
</pre>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2459" rel="bookmark" title="Permanent Link to:  Read-only file system のファイルシステムエラー発生" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2459#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=5" rel="category">CentOS</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2454 post type-post status-publish format-standard hentry category-elixir category-tech" id="post-2454">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2454" rel="bookmark" title="ElixirのHeadとTailについて">ElixirのHeadとTailについて</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年7月16日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<p>[head | tail]の挙動が、いまひとつわからなかった。<br />
しかし、どうもErlang や Elixir の構文では、この概念が重要な気がしたので、ちょっと理解をしようと思う。</p>
<p>リストを作成して、[head | tail]で受けると、リストの先頭と、それ以降が分割される。</p>
<pre class="brush: bash; title: ; notranslate" title="">
iex(1)&gt; list = [1,2,3,4,5]
[1, 2, 3, 4, 5]
iex(2)&gt; [head | tail] = list
[1, 2, 3, 4, 5]
iex(3)&gt; head
1
iex(4)&gt; tail
[2, 3, 4, 5]
</pre>
<p>ちなみに、リストを分割する関数も存在する。</p>
<pre class="brush: bash; title: ; notranslate" title="">
iex(5)&gt; hd(list)
1
iex(6)&gt; tl(list)
[2, 3, 4, 5]
</pre>
<p>この概念は、再帰処理とかで基本になるので、ここで整理しておく。</p>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2454" rel="bookmark" title="Permanent Link to:  ElixirのHeadとTailについて" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2454#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=53" rel="category">Elixir</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2452 post type-post status-publish format-standard hentry category-elixir category-tech" id="post-2452">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2452" rel="bookmark" title="Elixir ファイル読み込み">Elixir ファイル読み込み</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年7月15日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<p>File読込み。</p>
<pre class="brush: bash; title: ; notranslate" title="">
defmodule FileIO do
    def main do
        {:ok, file} = File.open(&quot;sample.txt&quot;, [:read, :utf8])
        Enum.each(IO.stream(file, :line), fn(line) -&gt;
            IO.puts line
        end )
        File.close(file)
    end
end
</pre>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2452" rel="bookmark" title="Permanent Link to:  Elixir ファイル読み込み" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2452#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=53" rel="category">Elixir</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2447 post type-post status-publish format-standard hentry category-elixir category-tech" id="post-2447">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2447" rel="bookmark" title="Elixir プログラムの実行方法">Elixir プログラムの実行方法</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年7月14日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<p>下記のモジュールファイルを作成する。</p>
<p>MyModule.exs</p>
<pre class="brush: bash; title: ; notranslate" title="">
defmodule MyModule do
  def hello() do
    IO.puts &quot;Hello&quot;
  end
end
</pre>
<p>これを実行するには、下記コマンドにてコンパイルする。</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ elixirc MyModule.exs 
</pre>
<p>または、コンソールにてコンパイル。</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ iex
Erlang/OTP 18 [erts-7.3]  [64-bit] [smp:4:4] [async-threads:10] [hipe] [kernel-poll:false] [dtrace]

Interactive Elixir (1.3.1) - press Ctrl+C to exit (type h() ENTER for help)
iex(1)&gt; c(&quot;MyModule.exs&quot;)
[MyModule]
</pre>
<p>そのまま実行するには、</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ elixir -e MyModule.hello
Hello
</pre>
<p>iexから実行するには、</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ iex MyModule.exs 
Erlang/OTP 18 [erts-7.3]  [64-bit] [smp:4:4] [async-threads:10] [hipe] [kernel-poll:false] [dtrace]

warning: redefining module MyModule (current version loaded from Elixir.MyModule.beam)
  MyModule.exs:1

Interactive Elixir (1.3.1) - press Ctrl+C to exit (type h() ENTER for help)
iex(1)&gt; MyModule.hello
Hello
:ok
</pre>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2447" rel="bookmark" title="Permanent Link to:  Elixir プログラムの実行方法" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2447#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=53" rel="category">Elixir</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2445 post type-post status-publish format-standard hentry category-elixir category-tech" id="post-2445">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2445" rel="bookmark" title="Elixir関数定義">Elixir関数定義</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年7月14日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<p>以下は、同じらしい。</p>
<pre class="brush: bash; title: ; notranslate" title="">
    fun = &amp;(&amp;1 + 5)
    fun.(2)
</pre>
<pre class="brush: bash; title: ; notranslate" title="">
    fun2 = fn(a) -&gt; a + 5 end
    fun2.(2)
</pre>
<p>関数型言語の慣れが必要です。</p>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2445" rel="bookmark" title="Permanent Link to:  Elixir関数定義" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2445#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=53" rel="category">Elixir</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2443 post type-post status-publish format-standard hentry category-elixir category-tech" id="post-2443">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2443" rel="bookmark" title="Elixir エラーハンドリングのパターン">Elixir エラーハンドリングのパターン</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年7月14日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<p>存在しないファイルを読み込んだ時、:ok は帰ってこない為、パターンマッチに失敗してエラーとなる。</p>
<pre class="brush: bash; title: ; notranslate" title="">
iex(1)&gt; {:ok, file} = File.read &quot;non_exist_file.txt&quot;
** (MatchError) no match of right hand side value: {:error, :enoent}
</pre>
<p>存在しないファイルを読み込んだ時、:error が帰ってくる為、パターンマッチに失敗しない。</p>
<pre class="brush: bash; title: ; notranslate" title="">
iex(2)&gt; {:error, enoent} = File.read &quot;non_exist_file.txt&quot;
{:error, :enoent}
</pre>
<p>普通の言語なら、下記の2つの文をif文で制御するところだが、上記の制御を振り分けるためには、case文を使用するようだ。</p>
<pre class="brush: bash; title: ; notranslate" title="">
case File.read &quot;non_exist_file.txt&quot; do
    {:ok, file} -&gt; IO.puts &quot;OK!!&quot;
    {:error, enoent} -&gt; IO.puts &quot;File not found Error!!&quot;
end
</pre>
<p>中々、慣れない。</p>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2443" rel="bookmark" title="Permanent Link to:  Elixir エラーハンドリングのパターン" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2443#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=53" rel="category">Elixir</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2441 post type-post status-publish format-standard hentry category-elixir category-tech" id="post-2441">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2441" rel="bookmark" title="Elixir 久しぶりの復習その2">Elixir 久しぶりの復習その2</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年7月14日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<p>カレントパスのファイル名を取得して、ファイルに書き出す処理。</p>
<pre class="brush: bash; title: ; notranslate" title="">
{:ok, files} = File.ls(&quot;.&quot;)

{:ok, file} = File.open &quot;filelist.txt&quot;, [:write]
Enum.map(files, &amp;IO.write(file, &amp;1&lt;&gt;&quot;\n&quot;))
File.close file

</pre>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2441" rel="bookmark" title="Permanent Link to:  Elixir 久しぶりの復習その2" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2441#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=53" rel="category">Elixir</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2438 post type-post status-publish format-standard hentry category-elixir category-tech" id="post-2438">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2438" rel="bookmark" title="Elixir 久しぶりの復習">Elixir 久しぶりの復習</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年7月13日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<pre class="brush: bash; title: ; notranslate" title="">
defmodule Hello do
    def hello do
        IO.puts &quot;Hello Tajima!!!&quot;
    end

    def goody do
        IO.puts &quot;Good night Tajima!!!&quot;
    end

    def dir do
        {:ok, files} = File.ls(&quot;.&quot;)
        #IO.puts &quot;こんにちは。&quot;
        #File.mkdir(&quot;dir&quot;)
        Enum.map(files, &amp;IO.puts(&amp;1))
    end
end
</pre>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2438" rel="bookmark" title="Permanent Link to:  Elixir 久しぶりの復習" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2438#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=53" rel="category">Elixir</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2434 post type-post status-publish format-standard hentry category-tech" id="post-2434">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2434" rel="bookmark" title="Redmineバックアップスクリプト">Redmineバックアップスクリプト</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年5月13日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<pre class="brush: bash; title: ; notranslate" title="">
#!/bin/sh
#
# Redmine DB backup script
# 

FILE_DIR=/app/redmine/files/
DMP_DIR=/var/tmp/
MNT_DIR=/mnt/rm/
BAK_DIR=&quot;//10.0.0.0/windows/Backup/dir/rm&quot;
PERIOD=5
DB_USER=dbuser
DB_PASS=xxxxxx

USER_NAME=username
PASSWD=xxxxxxx
EXIT_STATUS=0

FILE_NAME=`date +%y%m%d`
RM_FILE_NAME=`date --date &quot;$PERIOD days ago&quot; +%y%m%d`

DMP_FILE=$DMP_DIR/Redmine_DB_$FILE_NAME.sql.gz
ARC_FILE=$DMP_DIR/Redmine_FILE_$FILE_NAME.tar.gz

RM_DMP_FILE=$MNT_DIR/Redmine_DB_$RM_FILE_NAME.sql.gz
RM_ARC_FILE=$MNT_DIR/Redmine_FILE_$RM_FILE_NAME.tar.gz

# ファイルサーバへマウント
mount -t cifs -o username=$USER_NAME,password=$PASSWD $BAK_DIR $MNT_DIR

# データのダンプ
mysqldump --opt --single-transaction --default-character-set=binary -u $DB_USER --password=$DB_PASS --all-databases | gzip &gt; $DMP_FILE
echo &quot;Redmine DB Backup OK&quot;

# 添付ファイルのアーカイブ
tar cfvz $ARC_FILE $FILE_DIR
echo &quot;Redmine Files Backup OK&quot;

# ファイルの移動
mv $DMP_FILE $MNT_DIR
mv $ARC_FILE $MNT_DIR
echo &quot;Redmine Files Move to Server OK&quot;

# ファイルの削除
rm $RM_DMP_FILE
rm $RM_ARC_FILE
echo &quot;Redmine Files Cleanup OK&quot;

umount -l $MNT_DIR

exit $EXIT_STATUS
</pre>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2434" rel="bookmark" title="Permanent Link to:  Redmineバックアップスクリプト" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2434#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>
<div class="post-2432 post type-post status-publish format-standard hentry category-python category-tech" id="post-2432">

<!--Post title-->
<h2 class="title"><a href="http://www.whoocus.com/blog/?p=2432" rel="bookmark" title="SVNバックアップスクリプト">SVNバックアップスクリプト</a></h2>

<!--Date, Time and Author-->
<p class="meta"><span class="clock"></span><span class="date">2016年5月13日</span><span class="posted"> Posted by  PURGE  </span></p>
<!--Post content-->
<div class="entry">
	<pre class="brush: bash; title: ; notranslate" title="">
#!/bin/sh
#
# SVN Repo backup script
#
REPO_DIR=/var/www/svn/repos/
MNT_DIR=/mnt/svn/
BAK_DIR=&quot;//10.0.0.0/windows/Backup/dir/svn&quot;
HOT_BACKUP=/usr/share/doc/subversion-1.4.2/tools/backup/hot-backup.py
USER_NAME=username
PASSWD=xxxxxx

EXIT_STATUS=0
# 保存世代数(NOT WORKING)
# 実際のスクリプトに記載すること
export SVN_HOTBACKUP_BACKUPS_NUMBER=7

mount -t cifs -o username=$USER_NAME,password=$PASSWD $BAK_DIR $MNT_DIR

for REPO in `find $REPO_DIR -maxdepth 1 -mindepth 1 -type d`
do
  $HOT_BACKUP --archive-type=gz $REPO $MNT_DIR
  if [ $? = 0 ]; then
    logger &quot;SVN Backup done. repository:$REPO, $BKFILE&quot;
    echo &quot;SVN Backup OK $BKFILE&quot;
  else
    logger &quot;SVN Backup NG $BKFILE&quot;
    echo &quot;SVN Backup NG $BKFILE&quot;
    EXIT_STATUS=1
  fi
done

umount -l $MNT_DIR

exit $EXIT_STATUS
</pre>
    <div class="clearer"></div>
</div>
<!--Post footer-->
<div class="postfooter"><a href="http://www.whoocus.com/blog/?p=2432" rel="bookmark" title="Permanent Link to:  SVNバックアップスクリプト" class="more">Read full article</a>
<span class="full_post"></span> |<span class="commentbouble"></span><a href="http://www.whoocus.com/blog/?p=2432#respond">Leave a comment</a><br/>Tags: No tags
<br/>Categories: <a href="http://www.whoocus.com/blog/?cat=45" rel="category">Python</a>, <a href="http://www.whoocus.com/blog/?cat=4" rel="category">技術情報</a></div></div>

<!-- Older / newer posts -->
<div class="navigation">
			<div class="alignleft"><a href="http://www.whoocus.com/blog/?paged=2" >&laquo; Older Entries</a></div>
			<div class="alignright"></div>
            
</div>


    </div>
</div>
<!--Content end-->
<div class="right" id="sidebar">
    <div id="sidebar_content">

<ul>
<li id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="http://www.whoocus.com/blog/">
				<div>
					<label class="screen-reader-text" for="s">検索:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="検索" />
				</div>
			</form></li>		<li id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widgettitle-sidebar">最近の投稿</h3>		<ul>
					<li>
				<a href="http://www.whoocus.com/blog/?p=2459">Read-only file system のファイルシステムエラー発生</a>
						</li>
					<li>
				<a href="http://www.whoocus.com/blog/?p=2454">ElixirのHeadとTailについて</a>
						</li>
					<li>
				<a href="http://www.whoocus.com/blog/?p=2452">Elixir ファイル読み込み</a>
						</li>
					<li>
				<a href="http://www.whoocus.com/blog/?p=2447">Elixir プログラムの実行方法</a>
						</li>
					<li>
				<a href="http://www.whoocus.com/blog/?p=2445">Elixir関数定義</a>
						</li>
				</ul>
		</li><li id="archives-2" class="widget widget_archive"><h3 class="widgettitle-sidebar">アーカイブ</h3>		<ul>
	<li><a href='http://www.whoocus.com/blog/?m=201608'>2016年8月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201607'>2016年7月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201605'>2016年5月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201604'>2016年4月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201603'>2016年3月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201602'>2016年2月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201510'>2015年10月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201509'>2015年9月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201508'>2015年8月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201507'>2015年7月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201506'>2015年6月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201505'>2015年5月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201504'>2015年4月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201503'>2015年3月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201502'>2015年2月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201501'>2015年1月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201412'>2014年12月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201411'>2014年11月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201410'>2014年10月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201409'>2014年9月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201407'>2014年7月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201406'>2014年6月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201405'>2014年5月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201404'>2014年4月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201403'>2014年3月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201402'>2014年2月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201401'>2014年1月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201311'>2013年11月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201310'>2013年10月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201309'>2013年9月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201308'>2013年8月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201307'>2013年7月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201306'>2013年6月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201305'>2013年5月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201304'>2013年4月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201303'>2013年3月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201302'>2013年2月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201301'>2013年1月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201212'>2012年12月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201211'>2012年11月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201210'>2012年10月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201208'>2012年8月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201207'>2012年7月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201206'>2012年6月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201205'>2012年5月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201204'>2012年4月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201202'>2012年2月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201201'>2012年1月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201112'>2011年12月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201111'>2011年11月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201110'>2011年10月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201109'>2011年9月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201108'>2011年8月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201107'>2011年7月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201106'>2011年6月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201105'>2011年5月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201104'>2011年4月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201103'>2011年3月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201102'>2011年2月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201101'>2011年1月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201007'>2010年7月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201004'>2010年4月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201003'>2010年3月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=201002'>2010年2月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=200905'>2009年5月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=200810'>2008年10月</a></li>
	<li><a href='http://www.whoocus.com/blog/?m=200806'>2008年6月</a></li>
		</ul>
</li><li id="categories-2" class="widget widget_categories"><h3 class="widgettitle-sidebar">カテゴリー</h3>		<ul>
	<li class="cat-item cat-item-55"><a href="http://www.whoocus.com/blog/?cat=55" >Atom</a>
</li>
	<li class="cat-item cat-item-51"><a href="http://www.whoocus.com/blog/?cat=51" >Backbone.js</a>
</li>
	<li class="cat-item cat-item-59"><a href="http://www.whoocus.com/blog/?cat=59" >Bluemix</a>
</li>
	<li class="cat-item cat-item-42"><a href="http://www.whoocus.com/blog/?cat=42" >C++</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.whoocus.com/blog/?cat=5" >CentOS</a>
</li>
	<li class="cat-item cat-item-60"><a href="http://www.whoocus.com/blog/?cat=60" >CmdPrompt</a>
</li>
	<li class="cat-item cat-item-43"><a href="http://www.whoocus.com/blog/?cat=43" >cocos2d-x</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://www.whoocus.com/blog/?cat=6" >CSS</a>
</li>
	<li class="cat-item cat-item-48"><a href="http://www.whoocus.com/blog/?cat=48" >D3.js</a>
</li>
	<li class="cat-item cat-item-46"><a href="http://www.whoocus.com/blog/?cat=46" >eclipse</a>
</li>
	<li class="cat-item cat-item-36"><a href="http://www.whoocus.com/blog/?cat=36" >edge</a>
</li>
	<li class="cat-item cat-item-53"><a href="http://www.whoocus.com/blog/?cat=53" >Elixir</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://www.whoocus.com/blog/?cat=7" >Excel</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://www.whoocus.com/blog/?cat=8" >Flex</a>
</li>
	<li class="cat-item cat-item-24"><a href="http://www.whoocus.com/blog/?cat=24" >git</a>
</li>
	<li class="cat-item cat-item-23"><a href="http://www.whoocus.com/blog/?cat=23" >heroku</a>
</li>
	<li class="cat-item cat-item-49"><a href="http://www.whoocus.com/blog/?cat=49" >iOS</a>
</li>
	<li class="cat-item cat-item-9"><a href="http://www.whoocus.com/blog/?cat=9" >Java</a>
</li>
	<li class="cat-item cat-item-10"><a href="http://www.whoocus.com/blog/?cat=10" >JavaScript</a>
</li>
	<li class="cat-item cat-item-33"><a href="http://www.whoocus.com/blog/?cat=33" >jQuery</a>
</li>
	<li class="cat-item cat-item-17"><a href="http://www.whoocus.com/blog/?cat=17" >Mac</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://www.whoocus.com/blog/?cat=11" >MySQL</a>
</li>
	<li class="cat-item cat-item-58"><a href="http://www.whoocus.com/blog/?cat=58" >Nginx</a>
</li>
	<li class="cat-item cat-item-38"><a href="http://www.whoocus.com/blog/?cat=38" >Objective-C</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://www.whoocus.com/blog/?cat=12" >Oracle</a>
</li>
	<li class="cat-item cat-item-54"><a href="http://www.whoocus.com/blog/?cat=54" >Phoenix Framework</a>
</li>
	<li class="cat-item cat-item-13"><a href="http://www.whoocus.com/blog/?cat=13" >php</a>
</li>
	<li class="cat-item cat-item-32"><a href="http://www.whoocus.com/blog/?cat=32" >Playframework</a>
</li>
	<li class="cat-item cat-item-39"><a href="http://www.whoocus.com/blog/?cat=39" >PureMVC</a>
</li>
	<li class="cat-item cat-item-45"><a href="http://www.whoocus.com/blog/?cat=45" >Python</a>
</li>
	<li class="cat-item cat-item-25"><a href="http://www.whoocus.com/blog/?cat=25" >Rails</a>
</li>
	<li class="cat-item cat-item-27"><a href="http://www.whoocus.com/blog/?cat=27" >Roo</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://www.whoocus.com/blog/?cat=14" >Ruby</a>
</li>
	<li class="cat-item cat-item-41"><a href="http://www.whoocus.com/blog/?cat=41" >SAStruts</a>
</li>
	<li class="cat-item cat-item-31"><a href="http://www.whoocus.com/blog/?cat=31" >Scala</a>
</li>
	<li class="cat-item cat-item-40"><a href="http://www.whoocus.com/blog/?cat=40" >Seasar2</a>
</li>
	<li class="cat-item cat-item-26"><a href="http://www.whoocus.com/blog/?cat=26" >Spring</a>
</li>
	<li class="cat-item cat-item-37"><a href="http://www.whoocus.com/blog/?cat=37" >Struts</a>
</li>
	<li class="cat-item cat-item-47"><a href="http://www.whoocus.com/blog/?cat=47" >Swift</a>
</li>
	<li class="cat-item cat-item-15"><a href="http://www.whoocus.com/blog/?cat=15" >symfony</a>
</li>
	<li class="cat-item cat-item-16"><a href="http://www.whoocus.com/blog/?cat=16" >twitter</a>
</li>
	<li class="cat-item cat-item-18"><a href="http://www.whoocus.com/blog/?cat=18" >WordPress</a>
</li>
	<li class="cat-item cat-item-50"><a href="http://www.whoocus.com/blog/?cat=50" >Xcode</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.whoocus.com/blog/?cat=3" >一般</a>
</li>
	<li class="cat-item cat-item-22"><a href="http://www.whoocus.com/blog/?cat=22" >仕事</a>
</li>
	<li class="cat-item cat-item-34"><a href="http://www.whoocus.com/blog/?cat=34" >基礎知識</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://www.whoocus.com/blog/?cat=4" >技術情報</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://www.whoocus.com/blog/?cat=19" >投資</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://www.whoocus.com/blog/?cat=20" >株式</a>
</li>
	<li class="cat-item cat-item-30"><a href="http://www.whoocus.com/blog/?cat=30" >融資管理</a>
</li>
	<li class="cat-item cat-item-44"><a href="http://www.whoocus.com/blog/?cat=44" >証券</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://www.whoocus.com/blog/?cat=29" >財務</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://www.whoocus.com/blog/?cat=21" >金融</a>
</li>
	<li class="cat-item cat-item-35"><a href="http://www.whoocus.com/blog/?cat=35" >金融経済</a>
</li>
	<li class="cat-item cat-item-28"><a href="http://www.whoocus.com/blog/?cat=28" >銀行業務</a>
</li>
		</ul>
</li><li id="meta-2" class="widget widget_meta"><h3 class="widgettitle-sidebar">メタ情報</h3>			<ul>
						<li><a href="http://www.whoocus.com/blog/wp-login.php">ログイン</a></li>
			<li><a href="http://www.whoocus.com/blog/?feed=rss2">投稿の <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://www.whoocus.com/blog/?feed=comments-rss2">コメントの <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://ja.wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</li>	</ul>
    </div>
</div>
<div class="clearer"></div>
			</div>
		</div>
	</div>
</div> <div id="footer">
    <div class="center_wrapper-footer">
            <div id="content-footer">
        <div id="footer-main">
<div id="footer-sidebar1"><ul>
</ul>
</div>

<div id="footer-sidebar3"><ul>
</ul> </div>

<div id="footer-sidebar2"><ul>
</ul>
</div>


</div><div class="clearer">&nbsp;</div>
		<div class="left">
        <!--Blog title in footer--><div id="footer-title">
		<a href="http://www.whoocus.com/blog/" title="Whoocus" rel="home">
		Whoocus</a> 人と人をつなげるシステムを創造する     </div></div>
        <!--Credit link and powered by wordpress--><div id="credit">
<p style="float:right;margin-right:12px; font-size:10px;">Theme by <a href="http://w3blog.dk" title="w3blog" target="_blank">W3blog</a></p></div>
	<div class="clearer"></div>
	</div>
</div>
	<div style="display:none">
	</div>
<script type='text/javascript' src='http://www.whoocus.com/blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b'></script>
<script type='text/javascript' src='http://www.whoocus.com/blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0.9b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.whoocus.com/blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.whoocus.com/blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = 'ソースを表示';
	SyntaxHighlighter.config.strings.help = 'SyntaxHighlighterについて';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = '指定のブラシが見つかりませんでした: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'HTMLスクリプトのオプションのためにブラシが構成されませんでした: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201633'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2016Augaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.whoocus.com/blog/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.3.1'></script>
<script type='text/javascript' src='http://stats.wp.com/e-201633.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:3.7.2',blog:'100532980',post:'0',tz:'9',srv:'www.whoocus.com'} ]);
	_stq.push([ 'clickTrackerInit', '100532980', '0' ]);
</script>
</body>
</html>
